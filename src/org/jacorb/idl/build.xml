<?xml version="1.0"?>

<!DOCTYPE project [ <!ENTITY common SYSTEM "file:../../../../etc/common.xml"> ]>

<project name="idl" default="all" basedir="../../../..">

   &common;

   <target name="all" depends="init, parser">
      <!-- This replace is safety addition so if parser.cup has been -->
      <!-- regenerated then it will still build. Normally this will  -->
      <!-- have no affect and not alter parser.java                  -->
      <replace file="${src}/org/jacorb/idl/parser.java" token="java_cup.runtime"
               value="org.jacorb.idl.runtime" />
      <antcall target="jacorb-javac">
         <param name="javac-includes" value="org/jacorb/idl/**/*.java"/>
      </antcall>
   </target>

   <target name="parser" >
      <taskdef name="cup"
               classname="java_cup.anttask.CUPTask"
               classpath="${basedir}/lib/build/java_cup.jar"/>
      <cup srcfile="${basedir}/src/org/jacorb/idl/parser.cup"
           destdir="${basedir}/src"/>
   </target>
</project>
