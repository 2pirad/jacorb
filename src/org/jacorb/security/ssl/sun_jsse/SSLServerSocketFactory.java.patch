Index: SSLServerSocketFactory.java
===================================================================
RCS file: /cvsroot/jacorb/JacORB/src/org/jacorb/security/ssl/sun_jsse/SSLServerSocketFactory.java,v
retrieving revision 1.18
diff -r1.18 SSLServerSocketFactory.java
33a34,35
> import com.sun.net.ssl.*;
> 
120,131c122
<         
<         if (configuration.getAttribute("jacorb.security.ssl.server.protocols", null) != null)
<         {
<             enabledProtocols = (String[]) ((org.jacorb.config.Configuration)configuration).getAttributeList
<                                             ("jacorb.security.ssl.server.protocols").toArray();
<             if (logger.isDebugEnabled())
<             {
<                 logger.debug("Setting user specified server enabled protocols : " + 
<                              configuration.getAttribute("jacorb.security.ssl.server.protocols", ""));
<             }
<         }
<  
---
>          
185c176
<         if (request_mutual_auth) 
---
>         if (request_mutual_auth && ! require_mutual_auth) 
187,188c178,179
<             s.setWantClientAuth( request_mutual_auth );
<         } 
---
>              throw new RuntimeException("Request mutual authentication not supported with JSSE 1.0.x");
>         }
202,206d192
<         if (enabledProtocols != null)
<         {
<             s.setEnabledProtocols(enabledProtocols);
<         }
< 
217c203
<         if (request_mutual_auth) 
---
>         if (request_mutual_auth && ! require_mutual_auth) 
219c205
<             s.setWantClientAuth( request_mutual_auth );
---
>              throw new RuntimeException("Request mutual authentication not supported with JSSE 1.0.x");
234,238d219
<         if (enabledProtocols != null)
<         {
<             s.setEnabledProtocols(enabledProtocols);
<         }
< 
250c231
<         if (request_mutual_auth) 
---
>         if (request_mutual_auth && ! require_mutual_auth) 
252c233
<             s.setWantClientAuth( request_mutual_auth );
---
>              throw new RuntimeException("Request mutual authentication not supported with JSSE 1.0.x");
267,271d247
<         if (enabledProtocols != null)
<         {
<             s.setEnabledProtocols(enabledProtocols);
<         }
< 
282a259,260
>         Security.addProvider( new com.sun.net.ssl.internal.ssl.Provider() );
> 
