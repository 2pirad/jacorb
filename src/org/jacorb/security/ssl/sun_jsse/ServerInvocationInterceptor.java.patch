Index: ServerInvocationInterceptor.java
===================================================================
RCS file: /cvsroot/jacorb/JacORB/src/org/jacorb/security/ssl/sun_jsse/ServerInvocationInterceptor.java,v
retrieving revision 1.7
diff -r1.7 ServerInvocationInterceptor.java
53a54,55
>     
>     private CertificateFactory certificateFactory = null;
77c79,90
<               AccessId.value );   
---
>               AccessId.value );
>  
>        CertificateFactory cf = null;
>  
>        try 
>        {
>            certificateFactory = CertificateFactory.getInstance ("X.509");
>        }
>        catch( Exception e ) 
>        {
>            Debug.output( 1, e );
>        }      
123,127c136,158
<             kac = 
<                 new KeyAndCert( null,  sslSocket.getSession().getPeerCertificates() );
<         }
<         catch( javax.net.ssl.SSLPeerUnverifiedException pue )
<         {
---
>          if( certificateFactory == null ) 
>              {
>                  return;
>  
>              }
>  
>              javax.security.cert.X509Certificate[] certs 
>                  = sslSocket.getSession().getPeerCertificateChain(); 
>  
>              int size = certs.length;
>              java.security.cert.X509Certificate[] newCerts
>                  = new java.security.cert.X509Certificate[size];  
>  
>              for( int i = size - 1; 0 <= i; i-- ) 
>              {
>                newCerts[i] = (java.security.cert.X509Certificate) 
>                    certificateFactory.generateCertificate( new ByteArrayInputStream( certs[i].getEncoded()));
>              }
>  
>              kac = new KeyAndCert( null,  newCerts);
>          }
>          catch(java.security.cert.CertificateException pue)
>           {
130c161,171
<         }
---
>           }
>           catch( javax.net.ssl.SSLPeerUnverifiedException pue )
>           {
>             Debug.output( 2, pue );
>             return;
>           }
>           catch(javax.security.cert.CertificateEncodingException pue)
>          {
>              Debug.output( 2, pue );
>              return;
>           }
